<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>物联网操作系统AliOS Things 3.3: 飞机大战</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">物联网操作系统AliOS Things 3.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('aircraft_battle.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">飞机大战 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md953"></a>
实验介绍</h1>
<p>飞机大战作为一款经典的街机游戏，是很多人的童年回忆。我们的 HaaS EDU K1 开发板专门设计了街机样式的按键排列，很适合我们做这类游戏的开发。</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN01fFHJ801HyoDT19NYi_!!6000000000827-1-tps-1200-800.gif" alt="" style="zoom:50%;" class="inline"/> </div><h1><a class="anchor" id="autotoc_md954"></a>
涉及知识点</h1>
<p>OLED绘图 按键事件</p>
<h1><a class="anchor" id="autotoc_md955"></a>
开发环境准备</h1>
<h2><a class="anchor" id="autotoc_md956"></a>
硬件</h2>
<p>开发用电脑一台 HAAS EDU K1 开发板一块 USB2TypeC 数据线一根</p>
<h2><a class="anchor" id="autotoc_md957"></a>
软件</h2>
<h3><a class="anchor" id="autotoc_md958"></a>
AliOS Things开发环境搭建</h3>
<p>开发环境的搭建请参考 HaaS_EDU_K1_Quick_Start (搭建开发环境章节)，其中详细的介绍了AliOS Things 3.3的IDE集成开发环境的搭建流程。</p>
<h3><a class="anchor" id="autotoc_md959"></a>
HaaS EDU K1 DEMO 代码下载</h3>
<p>HaaS EDU K1 DEMO 的代码下载请参考 HaaS_EDU_K1_Quick_Start (创建工程章节)，其中， 选择解决方案: 基于教育开发板的示例 选择开发板: haaseduk1 board configure</p>
<h3><a class="anchor" id="autotoc_md960"></a>
代码编译、烧录</h3>
<p>参考 HaaS_EDU_K1_Quick_Start (3.1 编译工程章节)，点击 ✅ 即可完成编译固件。 参考 HaaS_EDU_K1_Quick_Start (3.2 烧录镜像章节)，点击 "⚡️" 即可完成烧录固件。</p>
<h1><a class="anchor" id="autotoc_md961"></a>
游戏设定</h1>
<p>不同于规则简单的贪吃蛇，在飞机大战这类游戏中，往往需要对游戏中出现的每个对象进行数值、行为的设定。在开发游戏前期，梳理好这些设定也有助于我们更清晰地进行开发。有时，优秀的设定也是吸引玩家的重要因素。 </p>
<h2><a class="anchor" id="autotoc_md962"></a>
角色设定</h2>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i4/O1CN01d8HY3L1eJnv3GDqni_!!6000000003851-2-tps-451-241.png" alt="" class="inline"/> </div><div align="center"> <img src="https://img.alicdn.com/imgextra/i3/O1CN017l0kl91MtpzerUl1V_!!6000000001493-2-tps-451-206.png" alt="" class="inline"/> </div><div align="center"> <img src="https://img.alicdn.com/imgextra/i4/O1CN01Bh1oSu1MWTnP9XmpP_!!6000000001442-2-tps-450-206.png" alt="" class="inline"/> </div><div align="center"> <img src="https://img.alicdn.com/imgextra/i4/O1CN01vX0n0x20SQvdUNLJs_!!6000000006848-2-tps-450-205.png" alt="" class="inline"/> </div><h2><a class="anchor" id="autotoc_md963"></a>
行为设定</h2>
<pre class="fragment">- 在本游戏中，玩家将控制阿克琉斯级战舰，在持续不断的敌机中通过闪避或攻击开辟出自己的路。
- 玩家可以通过 HaaS EDU K1 的四个按键控制 阿克琉斯级战舰 进行前后左右运动。
- 在游戏进行过程中，玩家的战舰会不断发射炮弹。被炮弹攻击的敌方战舰会损失响应的装甲。
- 若玩家战舰被敌方战舰撞击，双方均会损失装甲。
- 玩家有三次紧急修复战舰的机会。
</pre> <h1><a class="anchor" id="autotoc_md964"></a>
游戏实现</h1>
<h2><a class="anchor" id="autotoc_md965"></a>
游戏流程</h2>
<p>在开始之前，我们先使用一个简单的流程，帮助大家理解本游戏的刷新机制。这个大循化即游戏刷新所需要的所有流程。 </p><div class="fragment"><div class="line"><span class="comment">// 游戏中所有对象的更新判定由大循环维护</span></div>
<div class="line"><span class="keywordtype">void</span> aircraftBattle_task()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">while</span> (1)</div>
<div class="line">    {</div>
<div class="line">        OLED_Clear();           <span class="comment">// 清理屏幕数据</span></div>
<div class="line">        global_update();        <span class="comment">// 刷新全局对象 如更新对象的贴图状态 发射子弹 撞击判断 等</span></div>
<div class="line">        global_draw();          <span class="comment">// 绘制刷新完后的所有对象</span></div>
<div class="line">        OLED_Refresh_GRAM();<span class="comment">// 将绘制结果显示在屏幕上</span></div>
<div class="line">        <a class="code" href="group__aos__kernel__time.html#ga198267174bf34247bca2163293c20d5c">aos_msleep</a>(40);         <span class="comment">// 40ms 为一个游戏周期</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__aos__kernel__time_html_ga198267174bf34247bca2163293c20d5c"><div class="ttname"><a href="group__aos__kernel__time.html#ga198267174bf34247bca2163293c20d5c">aos_msleep</a></div><div class="ttdeci">void aos_msleep(uint32_t ms)</div></div>
</div><!-- fragment --><div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN018hWRfi1QiAMoH4hVJ_!!6000000002009-2-tps-579-394.png" alt="" class="inline"/> </div><h2><a class="anchor" id="autotoc_md966"></a>
贴图实现</h2>
<p>对于每个对象，我们希望能够将其定位到游戏地图上的每一点，而不是单纯使用贴图函数。因此，每个对象有一个“控制坐标”，而我们相对这个“控制坐标”计算出贴图坐标。这样，如果一个对象需要变换不同尺寸的贴图，我们可以更方便地计算出它的贴图坐标。 如图，红色为该对象的控制坐标，蓝色为该贴图的贴图坐标。</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN01tnIUT71Jy0l22oM7d_!!6000000001096-2-tps-384-384.png" alt="" style="zoom:50%;" class="inline"/> </div><p> &#160; <br  />
</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN01Zm97E01G9DzcNmDtv_!!6000000000579-2-tps-384-324.png" alt="" style="zoom:50%;" class="inline"/> </div><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    map_t *map;                         <span class="comment">// 贴图</span></div>
<div class="line">    <span class="keywordtype">int</span> cur_x; </div>
<div class="line">    <span class="keywordtype">int</span> cur_y;                          <span class="comment">// 飞行物对象的控制坐标</span></div>
<div class="line">} dfo_t;                                        <span class="comment">// 飞行物对象</span></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">    -&gt; x</span></div>
<div class="line"><span class="comment">    ____________________</span></div>
<div class="line"><span class="comment">    |         |    icon|</span></div>
<div class="line"><span class="comment"> |  |       of_y       |</span></div>
<div class="line"><span class="comment"> \/ |         |        |</span></div>
<div class="line"><span class="comment">  y |--of_x--cp        |</span></div>
<div class="line"><span class="comment">    |__________________|</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    icon_t *icon;       <span class="comment">// 贴图对象</span></div>
<div class="line">    <span class="keywordtype">int</span> offset_x;</div>
<div class="line">    <span class="keywordtype">int</span> offset_y;       <span class="comment">// 相对于控制坐标的偏移</span></div>
<div class="line">} map_t; <span class="comment">// 贴图</span></div>
</div><!-- fragment --><p> 注意⚠️，在开发过程中，我们使用的是竖屏模式，坐标系是以竖屏做处理。因此，在绘图时，我们需要做坐标系的转换。</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN01GOOOKe25dwxtslX50_!!6000000007550-2-tps-953-491.png" alt="" class="inline"/> </div><div class="fragment"><div class="line"><span class="keywordtype">void</span> draw_dfo(dfo_t *dfo)</div>
<div class="line">{</div>
<div class="line">    map_t *cur_map = get_cur_map(dfo);  <span class="comment">// 获取当前对象的贴图</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 计算对象边界</span></div>
<div class="line">    <span class="keywordtype">int</span> top = dfo-&gt;cur_y + cur_map-&gt;offset_y;   </div>
<div class="line">    <span class="keywordtype">int</span> bottom = dfo-&gt;cur_y + cur_map-&gt;offset_y + cur_map-&gt;icon-&gt;width;</div>
<div class="line">    <span class="keywordtype">int</span> left = dfo-&gt;cur_x + cur_map-&gt;offset_x;</div>
<div class="line">    <span class="keywordtype">int</span> right = dfo-&gt;cur_x + cur_map-&gt;offset_x + cur_map-&gt;icon-&gt;height;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 若对象超出屏幕 则不绘制</span></div>
<div class="line">    <span class="keywordflow">if</span> (top &gt; 132 || bottom &lt; 0 || left &gt; 64 || right &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 绘制坐标转换后的贴图对象</span></div>
<div class="line">    OLED_Icon_Draw(</div>
<div class="line">        dfo-&gt;cur_y + cur_map-&gt;offset_y,</div>
<div class="line">        64 - (dfo-&gt;cur_x + cur_map-&gt;offset_x + cur_map-&gt;icon-&gt;height),</div>
<div class="line">        cur_map-&gt;icon,</div>
<div class="line">        2);</div>
<div class="line">}</div>
</div><!-- fragment --><p> 这样，就可以实现在OLED上绘制我们设定的战舰图片了。</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i1/O1CN01EejcyI1DtzaUfeMGg_!!6000000000275-2-tps-1200-800.png" alt="" style="zoom:50%;" class="inline"/> </div><h2><a class="anchor" id="autotoc_md967"></a>
移动战舰</h2>
<p>接下来，我们要实现的是根据用户的按键输入来移动战舰的贴图。在此之前，我们需要对 dfo_t 结构体进行更多的补充。我们额外定义一个 speed 属性，用于定义在用户每次操作时移动一定的距离。 注意，这里的前后左右均是在游戏坐标系中。 </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <span class="comment">// 舰船坐标</span></div>
<div class="line">    <span class="keywordtype">int</span> cur_x; <span class="comment">// 运动</span></div>
<div class="line">    <span class="keywordtype">int</span> cur_y;</div>
<div class="line">        <span class="comment">// 舰船速度</span></div>
<div class="line">    uint8_t speed;      <span class="comment">// 绝对固定</span></div>
<div class="line">    <span class="comment">// 舰船贴图</span></div>
<div class="line">    map_t *map;</div>
<div class="line">} dfo_t;                   <span class="comment">// Dentified Flying Object</span></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line">{</div>
<div class="line">    UP,</div>
<div class="line">    LEFT,</div>
<div class="line">    RIGHT,</div>
<div class="line">    DOWN</div>
<div class="line">} my_craft_dir_e_t;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> move_MyCraft(dfo_t *my_craft, my_craft_dir_e_t dir)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// 获取舰船当前的贴图对象</span></div>
<div class="line">    map_t *cur_map = get_cur_map(my_craft);</div>
<div class="line">    <span class="comment">// 计算贴图边界</span></div>
<div class="line">    <span class="keywordtype">int</span> top = my_craft-&gt;cur_y + cur_map-&gt;offset_y;</div>
<div class="line">    <span class="keywordtype">int</span> bottom = my_craft-&gt;cur_y + cur_map-&gt;offset_y + cur_map-&gt;icon-&gt;width;</div>
<div class="line">    <span class="keywordtype">int</span> left = my_craft-&gt;cur_x + cur_map-&gt;offset_x;</div>
<div class="line">    <span class="keywordtype">int</span> right = my_craft-&gt;cur_x + cur_map-&gt;offset_x + cur_map-&gt;icon-&gt;height;</div>
<div class="line">        <span class="comment">// 判断方向</span></div>
<div class="line">    <span class="keywordflow">switch</span> (dir)</div>
<div class="line">    {</div>
<div class="line">    <span class="keywordflow">case</span> UP:</div>
<div class="line">        <span class="comment">// 如果这次移动不会超过地图边界 则移动</span></div>
<div class="line">        <span class="keywordflow">if</span> (!(top - my_craft-&gt;speed &lt; 0))</div>
<div class="line">            my_craft-&gt;cur_y -= my_craft-&gt;speed;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> DOWN:</div>
<div class="line">        <span class="keywordflow">if</span> (!(bottom + my_craft-&gt;speed &gt; 132))</div>
<div class="line">            my_craft-&gt;cur_y += my_craft-&gt;speed;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> LEFT:</div>
<div class="line">        <span class="keywordflow">if</span> (!(left - my_craft-&gt;speed &lt; 0))</div>
<div class="line">            my_craft-&gt;cur_x -= my_craft-&gt;speed;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> RIGHT:</div>
<div class="line">        <span class="keywordflow">if</span> (!(right + my_craft-&gt;speed &gt; 64))</div>
<div class="line">            my_craft-&gt;cur_x += my_craft-&gt;speed;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> 将按键回调函数关联至移动舰船函数。注意，这里的前后左右均是在游戏坐标系中。 </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> aircraftBattle_key_handel(key_code_t key_code)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (key_code)</div>
<div class="line">    {</div>
<div class="line">    <span class="keywordflow">case</span> EDK_KEY_4:</div>
<div class="line">        move_MyCraft(my_craft, LEFT);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> EDK_KEY_1:</div>
<div class="line">        move_MyCraft(my_craft, UP);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> EDK_KEY_3:</div>
<div class="line">        move_MyCraft(my_craft, DOWN);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> EDK_KEY_2:</div>
<div class="line">        move_MyCraft(my_craft, RIGHT);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><div align="center"> <img src="https://img.alicdn.com/imgextra/i4/O1CN01PZPCi622CynOOUGGa_!!6000000007085-1-tps-1200-800.gif" alt="" style="zoom:50%;" class="inline"/> </div><h2><a class="anchor" id="autotoc_md968"></a>
加一点特效</h2>
<p>作为一个注重细节，精益求精的开发者，我们希望给我们的舰船加上一些特效。而这需要舰船对象不断改变重绘自己的贴图。为了这个功能，我们额外创建了一个新的结构体用于管理“动画”。 </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    map_t **act_seq_maps;               <span class="comment">// 贴图指针数组 该动画的所有贴图（例如爆炸动作包含3帧）</span></div>
<div class="line">    uint8_t act_seq_len;                <span class="comment">// 贴图指针数组长度</span></div>
<div class="line">    uint8_t act_seq_index;              <span class="comment">// 用于索引帧</span></div>
<div class="line">    </div>
<div class="line">    uint8_t act_seq_interval;           <span class="comment">// 帧间延迟</span></div>
<div class="line">    uint8_t act_seq_interval_cnt;       <span class="comment">// 用于延迟计数</span></div>
<div class="line">    </div>
<div class="line">    uint8_t act_is_destory;                     <span class="comment">// 用于标记该动画是否是毁灭动画 若是则不再重复</span></div>
<div class="line">} act_seq_t;</div>
</div><!-- fragment --><p> 同时，每个舰船对象新增了一系列属性 act_seq_type， 用于显示当前的贴图状态。例如，当 act_seq_type = 0 时，表示舰船处于正常状态，每隔 act_seq_interval 个周期切换显示一次贴图，即第一行的三帧贴图。当 act_seq_type = 1 时，表示舰船处于爆炸状态，每隔 act_seq_interval 个周期切换显示一次贴图，即第二行的三帧贴图。 目前 act_seq_type 的含义由每个舰船对象自己定义和维护。也可以归纳成统一的枚举量，这一步读者可以自行完成。</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN01lFBMge1IN5CwY4VTI_!!6000000000880-2-tps-509-296.png" alt="" class="inline"/> </div><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> cur_x;</div>
<div class="line">    <span class="keywordtype">int</span> cur_y;</div>
<div class="line">    uint8_t speed;</div>
<div class="line"> </div>
<div class="line">    act_seq_t **act_seq_list; <span class="comment">// 动画数组 包含了多个动作序列</span></div>
<div class="line">    uint8_t act_seq_list_len; <span class="comment">// 动画数组长度</span></div>
<div class="line">    uint8_t act_seq_type;</div>
<div class="line">} dfo_t; </div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="comment">// 正常动作序列    </span></div>
<div class="line">act_seq_t *achilles_normal_act = (act_seq_t *)malloc(<span class="keyword">sizeof</span>(act_seq_t));</div>
<div class="line">achilles_normal_act-&gt;act_seq_maps = achilles_normal_maplist;</div>
<div class="line">achilles_normal_act-&gt;act_seq_len = 3;           <span class="comment">// 该动作序列包含3帧图片</span></div>
<div class="line">achilles_normal_act-&gt;act_seq_interval = 10;     <span class="comment">// 该动画帧间延迟10周期</span></div>
<div class="line">achilles_normal_act-&gt;act_is_destory = 0;        <span class="comment">// 该动画不是毁灭动画 即一直重复</span></div>
<div class="line"><span class="comment">// 毁灭动作序列    </span></div>
<div class="line">act_seq_t *achilles_destory_act = (act_seq_t *)malloc(<span class="keyword">sizeof</span>(act_seq_t));</div>
<div class="line">achilles_destory_act-&gt;act_seq_maps = achilles_destory_maplist;</div>
<div class="line">achilles_destory_act-&gt;act_seq_len = 3;</div>
<div class="line">achilles_destory_act-&gt;act_seq_interval = 4;     <span class="comment">// 该动画帧间延迟4周期</span></div>
<div class="line">achilles_destory_act-&gt;act_is_destory = 1;</div>
<div class="line"><span class="comment">// 动作序列数组</span></div>
<div class="line">act_seq_t **achilles_act_seq_list = (act_seq_t **)malloc(<span class="keyword">sizeof</span>(act_seq_t *) * achilles-&gt;act_seq_list_len);</div>
<div class="line">achilles_act_seq_list[0] = achilles_normal_act;</div>
<div class="line">achilles_act_seq_list[1] = achilles_destory_act;</div>
<div class="line"><span class="comment">// 将舰船对象属性指向该动作序列数组</span></div>
<div class="line">achilles-&gt;act_seq_list = achilles_act_seq_list;</div>
<div class="line">achilles-&gt;act_seq_type = 0;</div>
</div><!-- fragment --><p> 定义完成后，我们需要在游戏的每一次循环中，更新战舰状态和贴图。 </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> craft_update_act(dfo_t *craft)</div>
<div class="line">{</div>
<div class="line">    act_seq_t *cur_act_seq = craft-&gt;act_seq_list[craft-&gt;act_seq_type];</div>
<div class="line">    <span class="keywordflow">if</span> (cur_act_seq-&gt;act_seq_interval == 0)</div>
<div class="line">        <span class="keywordflow">return</span>; <span class="comment">// 若当前战舰无动作序列，则不进行更新</span></div>
<div class="line">    ++(cur_act_seq-&gt;act_seq_interval_cnt);</div>
<div class="line">    <span class="keywordflow">if</span> (cur_act_seq-&gt;act_seq_interval_cnt &gt;= cur_act_seq-&gt;act_seq_interval)</div>
<div class="line">    {</div>
<div class="line">        cur_act_seq-&gt;act_seq_interval_cnt = 0;</div>
<div class="line">        ++(cur_act_seq-&gt;act_seq_index); <span class="comment">// 切换贴图</span></div>
<div class="line">        <span class="keywordflow">if</span> (cur_act_seq-&gt;act_seq_index &gt;= cur_act_seq-&gt;act_seq_len)</div>
<div class="line">        {</div>
<div class="line">            cur_act_seq-&gt;act_seq_index = 0;</div>
<div class="line">            <span class="keywordflow">if</span> (cur_act_seq-&gt;act_is_destory == 1)</div>
<div class="line">            {</div>
<div class="line">                                <span class="comment">// 在这里处理毁灭的舰船</span></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> 这样，我们就为战舰添加了喷气的特效。</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN01xPmTtB28sYRWTrbj6_!!6000000007988-1-tps-1200-800.gif" alt="" style="zoom:50%;" class="inline"/> </div><h2><a class="anchor" id="autotoc_md969"></a>
移动敌机</h2>
<p>移动敌机的方式更简单。只需要将其向下移动即可。实现方式如下。 </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> move_enemy(dfo_t *craft)</div>
<div class="line">{</div>
<div class="line">    map_t *cur_map = get_cur_map(craft);</div>
<div class="line">    craft-&gt;cur_y += craft-&gt;speed;</div>
<div class="line">    <span class="keywordtype">int</span> top = craft-&gt;cur_y + cur_map-&gt;offset_y;</div>
<div class="line">    <span class="keywordflow">if</span> (top &gt; 132)                                                                              <span class="comment">// 当敌机飞过屏幕下方</span></div>
<div class="line">        reload_dfo(craft, AUTO_RELOAD, AUTO_RELOAD);    <span class="comment">// 重载敌机</span></div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md970"></a>
重载敌机</h2>
<p>在飞机大战中，会有持续不断的敌机生成，并且敌机的出现顺序和位置都随机。为了实现这种效果，我们采用的方式是维护一个敌机数组，当敌机飞过屏幕下方或是被击落后，我们会回收敌机并重新加载，将其重新显示在屏幕上。 </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> reload_dfo(dfo_t *craft, <span class="keywordtype">int</span> pos_x, <span class="keywordtype">int</span> pos_y)</div>
<div class="line">{</div>
<div class="line">    craft-&gt;cur_x = craft-&gt;pos_x;</div>
<div class="line">    craft-&gt;cur_y = craft-&gt;pos_y;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (pos_x == AUTO_RELOAD)   <span class="comment">// 如果指定重载坐标为自动重载</span></div>
<div class="line">    {</div>
<div class="line">        uint16_t height = get_cur_map(craft)-&gt;icon-&gt;width;</div>
<div class="line">        craft-&gt;cur_x = random() % (64 - height) + height / 2;   <span class="comment">// 则随机生成一个坐标，且保证对象显示在地图内</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (pos_y == AUTO_RELOAD)</div>
<div class="line">    {</div>
<div class="line">        uint16_t width = get_cur_map(craft)-&gt;icon-&gt;height;</div>
<div class="line">        craft-&gt;cur_y = -(random() % 1000) - width / 2;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> 这样，就能够实现源源不断的敌机了。</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN013ttk521FYaJ1UKtgR_!!6000000000499-1-tps-1200-800.gif" alt="" style="zoom:50%;" class="inline"/> </div><h2><a class="anchor" id="autotoc_md971"></a>
发射子弹</h2>
<p>对于子弹而言，它和战舰的属性非常相似，因此我们在现有的舰船对象 dfo_t 上稍加改动即可。 </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line">{</div>
<div class="line">    Achilles,   <span class="comment">// 阿克琉斯级</span></div>
<div class="line">    Venture,    <span class="comment">// 冲锋者级</span></div>
<div class="line">    Ares,       <span class="comment">// 阿瑞斯级 战神级</span></div>
<div class="line">    TiTan,      <span class="comment">// 泰坦级</span></div>
<div class="line">    Bullet,             <span class="comment">// 子弹</span></div>
<div class="line">} dfo_model_e_t;        <span class="comment">// 飞行物型号</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> offset_x;</div>
<div class="line">    <span class="keywordtype">int</span> offset_y;       <span class="comment">// 炮台的相对位置</span></div>
<div class="line">} arms_t;                       <span class="comment">// 武装结构体</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    dfo_model_e_t model;        <span class="comment">// 型号</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 运动相关</span></div>
<div class="line">    <span class="keywordtype">int</span> start_x;                        <span class="comment">// 飞行物的起始位置 用于计算飞行距离</span></div>
<div class="line">    <span class="keywordtype">int</span> start_y;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> cur_x;                          <span class="comment">// 飞行物的当前位置</span></div>
<div class="line">    <span class="keywordtype">int</span> cur_y;</div>
<div class="line"> </div>
<div class="line">    uint8_t speed;              <span class="comment">// 飞行物的运动速度</span></div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> range;         <span class="comment">// 射程</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 显示相关</span></div>
<div class="line">    act_seq_t **act_seq_list;   <span class="comment">// 动画数组</span></div>
<div class="line">    uint8_t act_seq_list_len;   <span class="comment">// 动画数组长度</span></div>
<div class="line">    uint8_t act_seq_type;               <span class="comment">// 动画状态</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 攻击相关</span></div>
<div class="line">    arms_t **arms_list;    <span class="comment">// 武器装备数组</span></div>
<div class="line">    uint8_t arms_list_len; <span class="comment">// 武器数组长度</span></div>
<div class="line">} dfo_t;</div>
</div><!-- fragment --><p> 那么，目前 dfo_t 结构体不仅仅可以用于舰船，也可以用于定义子弹。接下来，我们为舰船定义炮台和子弹。 </p><div class="fragment"><div class="line">dfo_t *create_achilles()        <span class="comment">// 定义阿克琉斯级战舰</span></div>
<div class="line">{</div>
<div class="line">        <span class="comment">// 贴图等其他定义</span></div>
<div class="line"> </div>
<div class="line">    achilles-&gt;damage = 8;               <span class="comment">// 定义撞击伤害</span></div>
<div class="line">    achilles-&gt;full_life = 10;   <span class="comment">// 定义完整装甲值</span></div>
<div class="line">    achilles-&gt;cur_life = 10;    <span class="comment">// 初始化装甲值</span></div>
<div class="line"> </div>
<div class="line">    achilles-&gt;arms_list_len = 2;        <span class="comment">// 设定炮台数为2</span></div>
<div class="line">    achilles-&gt;arms_list = achilles_arms_list;   <span class="comment">// 定义炮台数组</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> achilles;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">dfo_t *create_bullet()</div>
<div class="line">{</div>
<div class="line">        <span class="comment">// 贴图等其他定义      </span></div>
<div class="line"> </div>
<div class="line">    bullet-&gt;damage = 1;                 <span class="comment">// 定义射击伤害</span></div>
<div class="line">    bullet-&gt;full_life = 1;              <span class="comment">// 定义完整装甲值</span></div>
<div class="line">    bullet-&gt;cur_life = 0;               <span class="comment">// 初始化子弹时 默认不激活</span></div>
<div class="line"> </div>
<div class="line">    bullet-&gt;start_x = -100;             <span class="comment">// 初始化子弹时 将其移出屏幕外不做处理</span></div>
<div class="line">    bullet-&gt;start_y = -100;</div>
<div class="line">    bullet-&gt;cur_x = -100;</div>
<div class="line">    bullet-&gt;cur_y = -100;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> bullet;</div>
<div class="line">}</div>
</div><!-- fragment --><p> 为了生成持续不断的子弹，我们也采用重载的方式去生成子弹。 </p><div class="fragment"><div class="line"><span class="comment">// 检索未被激活的子弹</span></div>
<div class="line">dfo_t *get_deactived_bullet()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; MAX_BULLET; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (bullet_group[i]-&gt;cur_life &lt;= 0)</div>
<div class="line">            <span class="keywordflow">return</span> bullet_group[i];</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 触发舰船射击子弹</span></div>
<div class="line"><span class="keywordtype">void</span> shut_craft(dfo_t *craft)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (craft-&gt;arms_list == NULL || craft-&gt;arms_list_len == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 从每个炮台重载子弹</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; craft-&gt;arms_list_len; i++)</div>
<div class="line">    {</div>
<div class="line">        dfo_t *bullet = get_deactived_bullet();</div>
<div class="line">        <span class="keywordflow">if</span> (bullet == NULL)</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        reload_dfo(bullet, craft-&gt;cur_x + craft-&gt;arms_list[i]-&gt;offset_x, craft-&gt;cur_y + craft-&gt;arms_list[i]-&gt;offset_y);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 在每一次刷新时移动所有子弹</span></div>
<div class="line"><span class="keywordtype">void</span> move_bullet(dfo_t *bullet)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (bullet-&gt;cur_life &lt;= 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    map_t *cur_map = get_cur_map(bullet);</div>
<div class="line">    bullet-&gt;cur_y -= bullet-&gt;speed;</div>
<div class="line">    <span class="keywordtype">int</span> bottom = bullet-&gt;cur_y + cur_map-&gt;offset_y + cur_map-&gt;icon-&gt;width;</div>
<div class="line">    <span class="keywordflow">if</span> (bottom &lt; 0 || (bullet-&gt;start_y - bullet-&gt;cur_y) &gt; bullet-&gt;range)</div>
<div class="line">    {</div>
<div class="line">        bullet-&gt;cur_life = 0;   <span class="comment">// 对超出射程的子弹 取消激活</span></div>
<div class="line">        bullet-&gt;cur_x = -100;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><div align="center"> <img src="https://img.alicdn.com/imgextra/i4/O1CN01zhXJZ11rzZ2IWhd9I_!!6000000005702-1-tps-1200-800.gif" alt="" style="zoom:50%;" class="inline"/> </div><h2><a class="anchor" id="autotoc_md972"></a>
撞击判定</h2>
<p>在这一步，我们将会实现对于所有对象的撞击判定，并对对象的属性做出对应的处理。简单而言，撞击判定只需要检查两个对象是否有像素点的重叠即可。 </p><div class="fragment"><div class="line"><span class="comment">// 判断两个dfo对象 bullet craft 是否发生撞击</span></div>
<div class="line"><span class="keywordtype">int</span> hit_check(dfo_t *bullet, dfo_t *craft)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (craft-&gt;cur_y &lt;= 0 || craft-&gt;cur_x &lt;= 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    <span class="keywordflow">if</span> (craft-&gt;cur_life &lt;= 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    <span class="keywordflow">if</span> (bullet-&gt;cur_life &lt;= 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    act_seq_t *cur_act_seq = bullet-&gt;act_seq_list[bullet-&gt;act_seq_type];</div>
<div class="line">    map_t *cur_map = cur_act_seq-&gt;act_seq_maps[cur_act_seq-&gt;act_seq_index];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bullet_bit_x = 0; bullet_bit_x &lt; (cur_map-&gt;icon-&gt;height); bullet_bit_x++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bullet_bit_y = 0; bullet_bit_y &lt; (cur_map-&gt;icon-&gt;width); bullet_bit_y++)</div>
<div class="line">        {</div>
<div class="line">            uint8_t bit = (cur_map-&gt;icon-&gt;p_icon_mask == NULL) ? cur_map-&gt;icon-&gt;p_icon_data[bullet_bit_x / 8 + bullet_bit_y] &amp; (0x01 &lt;&lt; bullet_bit_x % 8) : cur_map-&gt;icon-&gt;p_icon_mask[bullet_bit_x / 8 + bullet_bit_y] &amp; (0x01 &lt;&lt; bullet_bit_x % 8);</div>
<div class="line">            <span class="keywordflow">if</span> (bit == 0)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">int</span> bit_cur_x = bullet-&gt;cur_x + cur_map-&gt;offset_x + cur_map-&gt;icon-&gt;height - bullet_bit_x;</div>
<div class="line">            <span class="keywordtype">int</span> bit_cur_y = bullet-&gt;cur_y + cur_map-&gt;offset_y + bullet_bit_y;</div>
<div class="line"> </div>
<div class="line">            act_seq_t *cur_craft_act_seq = craft-&gt;act_seq_list[craft-&gt;act_seq_type];</div>
<div class="line">            map_t *cur_craft_map = cur_craft_act_seq-&gt;act_seq_maps[cur_craft_act_seq-&gt;act_seq_index];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> craft_bit_x = 0; craft_bit_x &lt; (cur_craft_map-&gt;icon-&gt;height); craft_bit_x++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> craft_bit_y = 0; craft_bit_y &lt; (cur_craft_map-&gt;icon-&gt;width); craft_bit_y++)</div>
<div class="line">                {</div>
<div class="line">                    uint8_t craft_bit = (cur_craft_map-&gt;icon-&gt;p_icon_mask == NULL) ? cur_craft_map-&gt;icon-&gt;p_icon_data[craft_bit_x / 8 + craft_bit_y] &amp; (0x01 &lt;&lt; craft_bit_x % 8) : cur_craft_map-&gt;icon-&gt;p_icon_mask[craft_bit_x / 8 + craft_bit_y] &amp; (0x01 &lt;&lt; craft_bit_x % 8);</div>
<div class="line">                    <span class="keywordflow">if</span> (craft_bit == 0)</div>
<div class="line">                        <span class="keywordflow">continue</span>;</div>
<div class="line">                    <span class="comment">// 找到有效点对应的绝对坐标</span></div>
<div class="line">                    <span class="keywordtype">int</span> craft_bit_cur_x = craft-&gt;cur_x + cur_craft_map-&gt;offset_x + cur_craft_map-&gt;icon-&gt;height - craft_bit_x;</div>
<div class="line">                    <span class="keywordtype">int</span> craft_bit_cur_y = craft-&gt;cur_y + cur_craft_map-&gt;offset_y + craft_bit_y;</div>
<div class="line">                    <span class="comment">// 开始遍历所有可撞击对象</span></div>
<div class="line">                    <span class="keywordflow">if</span> (craft_bit_cur_x == bit_cur_x &amp;&amp; craft_bit_cur_y == bit_cur_y)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">return</span> 1;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> 全局撞击判定，判断地图上所有存活对象的撞击情况。 </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> global_hit_check(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// 子弹撞击检测</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; MAX_BULLET; j++)</div>
<div class="line">    {</div>
<div class="line">        dfo_t *bullet = bullet_group[j];</div>
<div class="line">        <span class="keywordflow">if</span> (bullet-&gt;cur_life &lt;= 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; MAX_L_CRAFT + MAX_M_CRAFT + MAX_S_CRAFT; i++)</div>
<div class="line">        {</div>
<div class="line">            dfo_t *craft = enemy_crafts[i];</div>
<div class="line">            <span class="keywordflow">if</span> (craft-&gt;cur_life &lt;= 0)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (hit_check(bullet, craft))</div>
<div class="line">            {</div>
<div class="line">                craft-&gt;cur_life -= bullet-&gt;damage;</div>
<div class="line">                bullet-&gt;cur_life = 0;</div>
<div class="line">                bullet-&gt;cur_x = -100;</div>
<div class="line">                <span class="keywordflow">if</span> (craft-&gt;cur_life &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                    destory(craft);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 我方飞机撞击检测</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; MAX_L_CRAFT + MAX_M_CRAFT + MAX_S_CRAFT; i++)</div>
<div class="line">    {</div>
<div class="line">        dfo_t *craft = enemy_crafts[i];</div>
<div class="line">        <span class="keywordflow">if</span> (craft-&gt;cur_life &lt;= 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (hit_check(my_craft, craft))</div>
<div class="line">        {</div>
<div class="line">            craft-&gt;cur_life -= my_craft-&gt;damage;</div>
<div class="line">            my_craft-&gt;cur_life -= craft-&gt;damage;</div>
<div class="line">            <span class="comment">// 如果舰船装甲损毁 则摧毁舰船 将其动画状态置为毁灭动画</span></div>
<div class="line">            <span class="keywordflow">if</span> (craft-&gt;cur_life &lt;= 0)</div>
<div class="line">            {</div>
<div class="line">                craft-&gt;act_seq_type = 1;</div>
<div class="line">                        craft-&gt;cur_life = 0;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (my_craft-&gt;cur_life &lt;= 0)</div>
<div class="line">            {</div>
<div class="line">                my_craft-&gt;act_seq_type = 1;</div>
<div class="line">                        my_craft-&gt;cur_life = 0;</div>
<div class="line">                g_chance--;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md973"></a>
全局刷新</h2>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> global_update(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; MAX_L_CRAFT + MAX_M_CRAFT + MAX_S_CRAFT; i++)</div>
<div class="line">    {</div>
<div class="line">        craft_update_act(enemy_crafts[i]);      <span class="comment">// 更新所有敌机贴图状态</span></div>
<div class="line">        move_enemy(enemy_crafts[i]);            <span class="comment">// 自动移动所有敌机</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; MAX_BULLET; i++)</div>
<div class="line">    {</div>
<div class="line">        move_bullet(bullet_group[i]);           <span class="comment">// 自动移动所有激活的子弹</span></div>
<div class="line">    }</div>
<div class="line">    craft_update_act(my_craft);                         <span class="comment">// 更新玩家舰船状态</span></div>
<div class="line">    shut_craft(my_craft);                                       <span class="comment">// 触发玩家舰船射击</span></div>
<div class="line">    global_hit_check();                                         <span class="comment">// 全局撞击判定</span></div>
<div class="line">}</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md974"></a>
实现效果</h1>
<p>接下来请欣赏笔者的操作。</p>
<div align="center"> <img src="https://img.alicdn.com/imgextra/i2/O1CN01PuExAK1BsV3zJrGs5_!!6000000000001-1-tps-1200-800.gif" alt="" style="zoom:50%;" class="inline"/> </div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">生成于 2021年 四月 16日 星期五 17:24:56 , 为 物联网操作系统AliOS Things 3.3使用  <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
